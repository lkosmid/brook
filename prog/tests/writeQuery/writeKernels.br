/*
 * writeKernels.br --
 *
 *      The kernels used in the writeQuery test.
 */


/*
 * krn_CopyStream --
 *
 *      Dead simple memcp() for streams.
 *
 * Results:
 *      The input is copied exactly to the output.
 */

kernel void
krn_CopyStream(float inStream<>, out float o<>)
{
   o = inStream;
}


/*
 * krn_CopyBelowThresholdKill --
 *
 *      Copies any elements on the input that are less than the given
 *      threshold to the output.  Kills the rest of the fragments.
 *
 * Results:
 *      See description.
 */

kernel void
krn_CopyBelowThresholdKill(float inStream<>, float t, out float o<>)
{
   if (inStream >= t) {
      discard;
   }
   o = inStream;
}


/*
 * krn_CopyBelowThresholdMask --
 *
 *      Unconditionally copies the input to the output.  Meant to be used in
 *      conjunction with a write_mask that applies the thresholding.
 *
 * Results:
 *      See description.
 */

kernel void
krn_CopyBelowThresholdMask(float inStream<>, out float o<>)
{
   o = inStream;
}
